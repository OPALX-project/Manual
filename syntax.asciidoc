ifdef::env-gitlab[]
include::Manual.attributes[]
include::env-gitlab.attributes[]
{link_home}

toc::[]
endif::[]

[appendix]
[[appendix.syntax]]
== OPAL Language Syntax

Words in _italic font_ are syntactic entities, and characters in
`monospaced font` must be entered as shown. Comments are given in *bold
font*.

[[sec.syntax.statements]]
=== Statements

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_comment_    | :  | `//` _anything-except-newline_
|             | \| | `/\*` __anything-except__ `*/` `*/`
|_identifier_ | :  | `[a-zA-Z][a-zA-Z0-9-]`
|_integer_ |: |`[0-9]+`
|_string_ |: |`’` __anything-except-single-quote__ `’`
| |\| |`"` anything-except-double-quote `"`
|_command_ |: |_keyword_ _attribute-list_
| |\| |_label_ `:` _keyword_ _attribute-list_
|_keyword_ |: |_identifier_
|_label_ |: |_identifier_
|_attribute-list_ |: |_empty_
| |\| |_attribute-list_ `,` _attribute_
|_attribute_ |: |_attribute-name_ *// only for logical attribute*
| |\| |_attribute-name_ `=` _attribute-value_
| | |*// expression evaluated*
| |\| |_attribute-name_ `:=` _attribute-value_
| | |*// expression retained*
|_attribute-name_ |: |_identifier_
|_attribute-value_ |: |_string-expression_
| |\| |_logical-expression_
| |\| |_real-expression_
| |\| |_array-expression_
| |\| |_constraint_
| |\| |_variable-reference_
| |\| |_place_
| |\| |_range_
| |\| |_token-list_
| |\| |_token-list-array_
| |\| |_regular-expression_
|===

[[sec.syntax.real-expressions]]
=== Real expressions

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_real-expression_ |: |_real-term_
| |\| |`+` _real-term_
| |\| |`-` _real-term_
| |\| |_real-expression_ `+` _real-term_
| |\| |_real-expression_ `-` _real-term_
|_real-term_ |: |_real-factor_
| |\| |_real-term_ `*` _real-factor_
| |\| |_real-term_ `/` _real-factor_
|_real-factor_ |: |_real-primary_
| |\| |_real-factor_ `^` _real-primary_
|_real-primary_ |: |_real-literal_
| |\| |_symbolic-constant_
| |\| |`#`
| |\| |_real-name_
| |\| |_array_ `[` _index_ `]`
| |\| |_object-name_ `->` _real-attribute_
| |\| |_object-name_ `->` _array-attribute_ `[` _index_ `]`
| |\| |_table-reference_
| |\| |_real-function_ `()`
| |\| |_real-function_ `(` _real-expression_ `)`
| |\| |_real-function_ `(` _real-expression_ `,` _real-expression_ `)`
| |\| |_function-of-array_ `(` _array-expression_ `)`
| |\| |`(` _real-expression_ `)`
|_real-function_ |: |`RANF`
| |\| |`GAUSS`
| |\| |`ABS`
| |\| |`TRUNC`
| |\| |`ROUND`
| |\| |`FLOOR`
| |\| |`CEIL`
| |\| |`SIGN`
| |\| |`SQRT`
| |\| |`LOG`
| |\| |`EXP`
| |\| |`SIN`
| |\| |`COS`
| |\| |`ABS`
| |\| |`TAN`
| |\| |`ASIN`
| |\| |`ACOS`
| |\| |`ATAN`
| |\| |`ATAN2`
| |\| |`MAX`
| |\| |`MIN`
| |\| |`MOD`
| |\| |`POW`
|_function-of-array_ |: |`VMIN`
| |\| |`VMAX`
| |\| |`VRMS`
| |\| |`VABSMAX`
|===

[[sec.syntax.real-variables-and-constants]]
=== Real variables and constants:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_real-prefix_ |: |empty
| |\| |`REAL`
| |\| |`REAL CONST`
| |\| |`CONST`
|_real-definition_ |: |_real-prefix_ _real-name_ `=` _real-expression_
| | |*// expression evaluated*
| |\| |_real-prefix_ _real-name_ `:=` _real-expression_
| | |*// expression retained*
|_symbolic-constant_ |: |`PI`
| |\| |`TWOPI`
| |\| |`DEGRAD`
| |\| |`RADDEG`
| |\| |`E`
| |\| |`EMASS`
| |\| |`PMASS`
| |\| |`HMMASS`
| |\| |`UMASS`
| |\| |`CMASS`
| |\| |`MMASS`
| |\| |`DMASS`
| |\| |`XEMASS`
| |\| |`CLIGHT`
| |\| |_real-name_
|_real-name_ |: |_identifier_
|_object-name_ |: |_identifier_
|_table-name_ |: |_identifier_
|_column-name_ |: |_identifier_
|===

[[sec.syntax.logical-expressions]]
=== Logical expressions:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_logical-expression_ |: |_and-expression_
| |\| |_logical-expression_ \|\| _and-expression_
|_and-expression_ |: |_relation_
| |\| |_and-expression_ `&&` _relation_
|_relation_ |: |_logical-name_
| |\| |`TRUE`
| |\| |`FALSE`
| |\| |_real-expression_ _relation-operator_ _real-expression_
|_logical-name_ |: |_identifier_
|_relation-operator_ |: |`==`
| |\| |`!=`
| |\| |`<`
| |\| |`>`
| |\| |`>=`
| |\| |`<=`
|===

[[sec.syntax.logical-variables]]
=== Logical variables:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_logical-prefix_ |: |`BOOL`
| |\| |`BOOL CONST`
|_logical-definition_ |: |_logical-prefix_ _logical-name_ `=`
_logical-expression_
| | |*// expression evaluated*
| |\| |_logical-prefix_ _logical-name `:=`_ _logical-expression_
| | |*// expression retained*
|===

[[sec.syntax.string-expressions]]
=== String expressions:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_string-expression_ |: |_string_
| |\| |_identifier_ *// taken as a string*
| |\| |_string-expression_ `&` _string_
|===

[[sec.syntax.string-constants]]
=== String constants:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_string-prefix_ |: |`STRING`
|_string-definition_ |: |_string-prefix_ _string-name_ `=`
_string-expression_
| | |*// expression evaluated*
| |\| |_string-prefix_ _string-name_ `:=` _string-expression_
| | |*// expression retained*
|===

[[sec.syntax.real-array-expressions]]
=== Real array expressions:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_array-expression_ |: |_array-term_
| |\| |`+` _array-term_
| |\| |`-` _array-term_
| |\| |_array-expression_ `+` _array-term_
| |\| |_array-expression_ `-` _array-term_
|_array-term_ |: |_array-factor_
| |\| |_array-term_ `*` _array-factor_
| |\| |_array-term_ `/` _array-factor_
|_array-factor_ |: |_array-primary_
| |\| |_array-factor_ `^` _array-primary_
|_array-primary_ |: |`{` _array-literal_ `}`
| |\| |_array-reference_
| |\| |_real-function_ `(` _array-expression_ `)`
| |\| |`(` _array-expression_ `)`
|_array-literal_ |: |_real-expression_
| |\| |_array-literal_ `,` _real expression_
|_array-reference_ |: |_array-name_
| |\| |_object-name_ `->` _array-attribute_
|_array-name_ |: |_identifier_
|===

[[sec.syntax.real-array-definitions]]
=== Real array definitions:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_array-prefix_ |: |`REAL VECTOR`
|_array-definition_ |: |_array-prefix_ _array-name_ `=`
_array-expression_
| |\| |_array-prefix_ _array-name_ `:=` _array-expression_
|===

[[sec.syntax.constraints]]
=== Constraints:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_constraint_ |: |_array-expression_ _constraint-operator_
_array-expression_
|_constraint-operator_ |: |`==`
| |\| |`<`
| |\| |`>`
|===

[[sec.syntax.variable-references]]
=== Variable references:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_variable-reference_ |: |_real-name_
| |\| |_object-name_ `->` _attribute-name_
|===

[[sec.syntax.token-lists]]
=== Token lists:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_token-list_ |: |_anything-except-comma_
|_token-list-array_ |: |_token-list_
| |\| |_token-list-array_ `,` _token-list_
|===

[[sec.syntax.regular-expressions]]
=== Regular expressions:

[cols="<2,^1,<5",frame=none,grid=none]
|===
|_regular-expression_ |: |`"`__UNIX-regular-expression__`"`
|===

// EOF