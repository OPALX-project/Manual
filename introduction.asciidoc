ifdef::env-gitlab[]
:stem: latexmath
:sectnums:
:toc: macro
:toclevels: 3

link:home[Back to Main Page]

toc::[]
endif::[]

[[chp.introduction]]
== Introduction

[[sec.introduction.aim-of-opal-and-history]]
=== History

Using the _MAD_ language with extensions, _OPAL_ is
derived from _MAD9P_ and is based on the _CLASSIC_ <<bib.classic>> class library, which
was started in 1995 by an international collaboration. IPPL (Independent
Parallel Particle Layer) is the framework which provides parallel
particles and fields using data parallel approach. IPPL was inspired by the POOMA <<bib.pooma>>.

_OPAL-t_ can be used to model guns,
injectors, ERLs and complete XFELs excluding the undulator.

[[sec.introduction.parallel-processing-capabilities]]
=== Parallel Processing Capabilities

_OPAL_ is built to harness the power of parallel processing for an
improved quantitative understanding of particle accelerators. This goal
can only be achieved with detailed 3D modelling capabilities and a
sufficient number of simulation particles to obtain meaningful
statistics on various quantities of the particle ensemble such as
emittance, slice emittance, halo extension etc.

The following example is exemplifying this fact:

.Parameters Parallel Performance Example
[[tab_pex1,Table {counter:tab-cnt}]]
|===
|Distribution | Particles | Mesh | Greens Function | Time steps

|Gauss 3D | latexmath:[10^8] | latexmath:[1024^3] | Integrated | 10
|===

<<fig_walldrift>> shows the parallel efficiency time as a function of
used cores for a test example with parameters given in <<tab_pex1>>. The
data were obtained on a Cray XT5 at the Swiss Center for Scientific
Computing.

.Parallel efficiency and particles pushed per latexmath:[\mu s] as a function of cores
[[fig_walldrift,Figure {counter:fig-cnt}]]
image::figures/drift2c1.png[scaledwidth=10cm,width=60%]

[[sec.introduction.quality-management]]
=== Quality Management

Documentation and quality assurance are given our highest attention
since we are convinced that adequate documentation is a key factor in
the usefulness of a code like _OPAL_ to study present and future
particle accelerators. Using tools such as a source code version control
system (https://git-scm.com[git]), source code documentation using
Doxygen (found http://amas.web.psi.ch/docs/opal/master-doxygen/[here]) and the
extensive user manual you are now enjoying, we are committed to
providing users as well as co-developers with state-of-the-art
documentation to _OPAL_.

One example of an non trivial test-example is the PSI DC GUN. In
<<fig_guncomp1>> the comparison between _Impact-t_ and _OPAL-t_ is
shown. This example is part of the regression test suite that is run
every night. The input file is found in
link:tutorial#sec.tutorial.examplesbeamlines[Examples of Particle Accelerators and Beamlines].

Misprints and obscurity are almost inevitable in a document of this
size. Comments and _active contributions_ from readers are therefore
most welcome. They may be sent to mailto:andreas.adelmann@psi.ch[Andreas Adelmann].

.Comparison of energy and emittance in latexmath:[x] between _Impact-t_ and _OPAL-t_
[[fig_guncomp1,Figure {counter:fig-cnt}]]
image::figures/Gun/GunComp.png[scaledwidth=10cm,width=80%]

[[sec.introduction.output]]
=== Output

The phase space is stored in the H5hut file-format <<bib.howison2010_intro>> and can be analyzed
using e.g. H5root <<bib.schietinger_intro>>. The frequency of the data output (phase space and
some statistical quantities) can be controlled using the `OPTION`
statement see link:control#sec.control.option[Option Statement], with the flag `PSDUMPFREQ`. The file is
named like in input file but with the extension .h5.

A SDDS compatible ASCII file with statistical beam parameters is written
to a file with extension .stat. The frequency with which this data is
written can be controlled with the `OPTION` statement
see link:control#sec.control.option[Option Statement] with the flag `STATDUMPFREQ`.

For postprocessing we recommend to use the https://gitlab.psi.ch/OPAL/pyOPALTools/wikis/home[pyOPALTools]
Python package which contains many tools for pre- and postprocessing, and analysing and plotting output data.

In addition to the output files, note that important information is displayed on the _stdout_ i.e. the _terminal_.
The user is advised to consult the stdout frequently.

.H5root enables a variety of data analysis and post processing task on _OPAL_ data
[[fig_H5root_analysis,Figure {counter:fig-cnt}]]
image::figures/H5rootPicture.png[scaledwidth=18cm,width=90%]

[[sec.introduction.change-history]]
=== Change History

See https://gitlab.psi.ch/OPAL/src/wikis/ReleaseNotes/ReleaseNotes[Release Notes]
for a detailed list of changes in _OPAL_.

[[sec.introduction.known-issues-and-limitations]]
=== Known Issues and Limitations

See the https://gitlab.psi.ch/OPAL/src/issues[issue list] in the repository.

See also link:pitfalls#chp.pitfalls[pitfalls and limitations].

[[sec.introduction.acknowledgments]]
=== Acknowledgments

The contributions of various individuals and groups are acknowledged in
the relevant chapters, however a few individuals have or had
considerable influence on the development of _OPAL_, namely
Chris Iselin,
John Jowett,
Julian Cummings,
Ji Qiang,
Robert Ryne
and Stefan Adam.
For the `H5root` visualization tool credits go to Thomas Schietinger.

The following individuals are acknowledged for past contributions:
Christian Baumgarten,
J. Scott Berg,
Yuanjie Bi,
David Bruhwiler,
Chris Cortes,
Martin Duy Tat,
Philippe Ganz,
Colwyn Gulliford,
Yves Ineichen,
Tulin Kaman,
Christopher Mayes,
Xiaoying Pang,
Valeria Rizzoglio,
Chuan Wang,
Jianjun Yang,
Hao Zha.

[[sec.introduction.citation]]
=== Citation

Please cite _OPAL_ in the following way:

....
@ARTICLE{2019arXiv190506654A,
       author = {{Adelmann}, Andreas and {Calvo}, Pedro and {Frey}, Matthias and
         {Gsell}, Achim and {Locans}, Uldis and {Metzger-Kraus}, Christof and
         {Neveu}, Nicole and {Rogers}, Chris and {Russell}, Steve and
         {Sheehy}, Suzanne and {Snuverink}, Jochem and {Winklehner}, Daniel},
        title = "{OPAL a Versatile Tool for Charged Particle Accelerator Simulations}",
      journal = {arXiv e-prints},
     keywords = {Physics - Accelerator Physics},
         year = "2019",
        month = "May",
          eid = {arXiv:1905.06654},
        pages = {arXiv:1905.06654},
archivePrefix = {arXiv},
       eprint = {1905.06654},
 primaryClass = {physics.acc-ph},
       adsurl = {https://ui.adsabs.harvard.edu/abs/2019arXiv190506654A},
      adsnote = {Provided by the SAO/NASA Astrophysics Data System}
}

....

[[sec.introduction.bibliography]]
=== References
[[bib.classic,*[{counter:bib-cnt}]*]] <<bib.classic>> F. C. Iselin, https://cds.cern.ch/record/311682/files/sl-96-061.pdf[_The classic project_], tech. rep. CERN/SL/96-061 (CERN, 1996).

[[bib.qiang2005_intro,*[{counter:bib-cnt}]*]] <<bib.qiang2005_intro>> J. Qiang et al.,  http://repositories.cdlib.org/lbnl/LBNL-59098[_A three-dimensional quasi-static model for high brightness beam dynamics simulation_], tech. rep. LBNL-59098 (LBNL).

[[bib.howison2010_intro,*[{counter:bib-cnt}]*]] <<bib.howison2010_intro>> M. Howison et al.,  http://dx.doi.org/10.1109/CLUSTERWKSP.2010.5613098[_H5hut: A High-Performance I/O Library for Particle-based Simulations_], in IEEE International Conference on Cluster Computing Workshops and Posters (2010), pp. 1â€“8, 10 . 1109 / CLUSTERWKSP.2010.5613098.

[[bib.schietinger_intro,*[{counter:bib-cnt}]*]] <<bib.schietinger_intro>> T. Schietinger, https://gitlab.psi.ch/OPAL/src/wikis/h5root[_H5root_], 2006.

[[bib.pooma,*[{counter:bib-cnt}]*]] <<bib.pooma>> http://www.nongnu.org/freepooma/

// EOF
